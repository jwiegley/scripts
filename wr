#!/usr/bin/env bash

set -e

ARGS=""
if [[ "$1" == "-f" || "$1" == "--force" ]]; then
    ARGS="--force"
    shift 1
fi

BRANCH="$1"
if [[ $BRANCH =~ johnw/(.+) ]]; then
    BRANCH="${BASH_REMATCH[1]}"
fi

git worktree remove $ARGS work/$BRANCH

if ! git branch -D johnw/$BRANCH
then
    git branch -D $BRANCH
fi
